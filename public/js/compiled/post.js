const mtgTooltip=function(e){arguments.length&&(this._settings=Object.assign({},this._settings,e)),this._settings.log&&console.log("mtgtooltip loaded"),this._settings.start&&this.start()};mtgTooltip.prototype={start:function(){if(this._settings.mobile&&window.innerWidth<=600&&window.innerHeight<=500)return void(this._settings.log&&console.log("Possible Mobile mode detected, exiting..."));this._alltogether(),this._settings.log&&console.log("mtgtooltip started");const e=this._settings.myclass,t=document.querySelector(this._settings.element);this.mymousemove(t);const s=t.querySelectorAll("."+e+":not(."+e+"mtgloaded)");this._settings.log&&console.log("found cards to create tooltip: ",s.length),s.forEach(e=>{e.style.cursor="pointer";let t=e.dataset.name,s=e.dataset.set,n=e.dataset.multiverseid,o=e.dataset.specialimg,i=e.innerHTML,a="https://gatherer.wizards.com/Handlers/Image.ashx?type=card",l="",d="",r="";if(!n&&!o){l=void 0!==t&&t.length>0?"&name="+encodeURI(t):"&name="+encodeURI(i).replace(/'/g,"%27"),void 0!==s&&s.length>0&&(d="&set="+s);const e=void 0!==t&&t.length>0?this.getSetLands(t):this.getSetLands(i);e&&(d="&set="+e)}void 0!==n&&n.length>0&&(r="&multiverseid="+n),void 0!==o&&o.length>0&&(a=this._settings.specialImage+o),a+=l+d+r,this.run(e,a)}),this._settings.log&&console.log("Created cards tooltips divs, starting creating the tooltips pairs")},run:function(e,t){const s=this._settings.myclass;let n=this._settings.id;const o=document.querySelector(this._settings.element);e.id=s+"_p"+n;let i=document.createElement("span");i.classList.add(s+"hover"),i.id=s+"_c"+n;let a="src";this._settings.lazyload&&(a="data-src");const l=this._settings.wrap_in,d=this._settings.wrap_out;i.innerHTML=`${l}<img ${a}='${t}' alt='mtgtooltip image' >${d}`,e.dataset.tooltipid=n,i.dataset.tooltipid=n,e.style.whiteSpace="nowrap",o.appendChild(i),i.style.display="none",i.style.opacity="0",i.classList.add(s+"tooltipstarted"),this._settings.id=n+1;let r=this;e.addEventListener("mouseover",function(e){r.mouseenter(e)}),e.addEventListener("mouseleave",function(e){r.mouseleave(e)})},mouseleave:function(e){let t=e.target.dataset.tooltipid;const s=this._settings.myclass,n=document.getElementById(s+"_c"+t);if(this._settings.log&&console.log("Mouse leave: ",e),this._settings.fadetime>0){let e=this._settings.fadetime;n.style.transition="all "+e+"ms ease-out",n.style.opacity=0,setTimeout(()=>{n.style.display="none",n.style.transition=""},e)}else n.style.display="none"},mouseenter:function(e){let t=e.target.dataset.tooltipid;const s=this._settings.myclass,n=document.getElementById(s+"_c"+t);if(this._settings.lazyload){const e=n.querySelector("img"),t=e.dataset.src;e.setAttribute("src",t)}n.style.position="absolute",n.style.opacity=this._settings.opacity,n.style.display="inline-block";let o=e.pageY,i=e.pageX,a=window.innerWidth,l=window.innerHeight,d=window.scrollY,r=window.scrollX,p=0,c=0;c=i+25,p=o+25,i+258>a+r&&(c=r+a-258,p=o-346-50),p+346>l+d&&(p=o-346),n.style.left=c+"px",n.style.top=p+"px"},mymousemove:function(e){const t=this;e.addEventListener("mousemove",function(e){t._settings.mousex=e.pageX,t._settings.mousey=e.pageY})},kill:function(){myclass=this._settings.myclass,document.querySelector(this._settings.element).querySelectorAll("."+myclass).forEach(e=>{e.removeEventListener("mouseover",function(e){that.mouseenter(e)}),e.removeEventListener("mouseleave",function(e){that.mouseleave(e)}),e.classList.remove(myclass),e.classList.remove("mtgloaded");let t=e.dataset.tooltipid;const s=document.getElementById(myclass+"_c"+t);s.parentNode.removeChild(s),e.removeAttribute("data-tooltipid"),e.removeAttribute("id")}),this._settings.log&&console.log(this._settings.name,"removed all instances of mtgtooltips")},_settings:{name:"MTG Tooltip js",version:"1.0",element:"body",myclass:"mtgtooltip",lazyload:!0,fadetime:300,opacity:1,mousex:0,mousey:0,id:0,log:!1,start:!0,wrap_in:"",wrap_out:"",specialImage:"",mobile:!0,basiclands:"ust",shocklands:"exp",fetchlands:"exp",painlands:"exp"},getSetLands:function(e){const t=e.toLowerCase();if(this._lands[t]){const e=this._lands[t].type.toLowerCase(),s=this._settings[e].toLowerCase(),n=this._lands[t][s];if(s&&n)return n.toUpperCase();{let s="";Object.values(this._lands[t]).forEach(t=>{t!=e&&(s+=t+" ")})}}return null},_shocklands:[{"blood crypt":{type:"shocklands",old:"dis",new:"rtr",exp:"exp"}},{"breeding pool":{type:"shocklands",old:"dis",new:"gtc",exp:"exp"}},{"godless shrine":{type:"shocklands",old:"gpt",new:"gtc",exp:"exp"}},{"hallowed fountain":{type:"shocklands",old:"dis",new:"rtr",exp:"exp"}},{"overgrown tomb":{type:"shocklands",old:"rav",new:"rtr",exp:"exp"}},{"sacred foundry":{type:"shocklands",old:"rav",new:"gtc",exp:"exp"}},{"steam vents":{type:"shocklands",old:"gpt",new:"rtr",exp:"exp"}},{"stomping ground":{type:"shocklands",old:"gpt",new:"gtc",exp:"exp"}},{"temple garden":{type:"shocklands",old:"rav",new:"rtr",exp:"exp"}},{"watery grave":{type:"shocklands",old:"rav",new:"gtc",exp:"exp"}}],_fetchlands:[{"arid mesa":{type:"fetchlands",old:"zen",new:"mm3",exp:"exp"}},{"bloodstained mire":{type:"fetchlands",old:"ons",new:"ktk",exp:"exp"}},{"flooded strand":{type:"fetchlands",old:"ons",new:"ktk",exp:"exp"}},{"marsh flats":{type:"fetchlands",old:"zen",new:"mm3",exp:"exp"}},{"misty rainforest":{type:"fetchlands",old:"zen",new:"mm3",exp:"exp"}},{"polluted delta":{type:"fetchlands",old:"ons",new:"ktk",exp:"exp"}},{"scalding tarn":{type:"fetchlands",old:"zen",new:"mm3",exp:"exp"}},{"verdant catacombs":{type:"fetchlands",old:"zen",new:"mm3",exp:"exp"}},{"windswept heath":{type:"fetchlands",old:"ons",new:"ktk",exp:"exp"}},{"wooded foothills":{type:"fetchlands",old:"ons",new:"ktk",exp:"exp"}}],_painlands:[{"adarkar wastes":{type:"painlands",old:"ie",new:"10e",exp:"6e"}},{"battlefield forge":{type:"painlands",old:"ap",new:"ori",exp:"10e"}},{brushland:{type:"painlands",old:"ie",new:"10e",exp:"6e"}},{"caves of koilos":{type:"painlands",old:"ap",new:"ori",exp:"10e"}},{"karplusan forest":{type:"painlands",old:"ap",new:"ori",exp:"10e"}},{"llanowar wastes":{type:"painlands",old:"ap",new:"ori",exp:"10e"}},{"shivan reef":{type:"painlands",old:"ap",new:"ori",exp:"10e"}},{"yavimaya coast":{type:"painlands",old:"ap",new:"ori",exp:"10e"}},{"underground river":{type:"painlands",old:"ap",new:"ori",exp:"10e"}},{"sulfurous springs":{type:"painlands",old:"ap",new:"ori",exp:"10e"}}],_basiclands:[{mountain:{type:"basiclands",uhn:"unh",ust:"ust",ugl:"ug"}},{plains:{type:"basiclands",uhn:"unh",ust:"ust",ugl:"ug"}},{forest:{type:"basiclands",uhn:"unh",ust:"ust",ugl:"ug"}},{swamp:{type:"basiclands",uhn:"unh",ust:"ust",ugl:"ug"}},{island:{type:"basiclands",uhn:"unh",ust:"ust",ugl:"ug"}}],_alltogether:function(){[this._shocklands,this._fetchlands,this._painlands,this._basiclands].forEach(e=>{e.forEach((t,s)=>{Object.assign(this._lands,e[s])})})},_lands:{}};var currentEventIndex=0,mtgEvents=null;$(document).ready(function(){function e(e){$("#top-decks").empty(),$("#top-decks").append("<div><small>Decks</small></div>");for(var t=0;t<e.decks.length;t++)$("#top-decks").append('<div><a href="'+e.decks[t].link+'" target="_blank"><small>'+e.decks[t].name+"</small></a></div>");if($("#top-decks").prepend('<div class="mb-3" style="width: 90%; margin: 0 auto;"><small>Event '+(currentEventIndex+1)+" of "+mtgEvents.length+'<br/><a href="'+e.event_link+'" target="_blank">'+e.event_name+"</a></small></div>"),mtgEvents.length>1){var s="";s+='<button data-index="'+(currentEventIndex-1)+'" type="button" class="prevMTGEventBtn btn btn-sm btn-link" '+(0==currentEventIndex?"disabled":"")+'><i class="fas fa-angle-double-left"></i> Prev Event</button>',s+='<button data-index="'+(currentEventIndex+1)+'" type="button" class="nextMTGEventBtn btn btn-sm btn-link" '+(currentEventIndex==mtgEvents.length-1?"disabled":"")+'>Next Event <i class="fas fa-angle-double-right"></i></button>',$("#top-decks").append('<div class="mt-3">'+s+"</div>")}}$.get("/api/mtg/top_decks",function(t){$("#top-decks .loader").hide(),t.length&&t[0].decks.length?(currentEventIndex=0,mtgEvents=t,e(t[0])):$("#top-decks").append("<div>Unable to retrieve data.</div>")}),$("body").on("click",".nextMTGEventBtn, .prevMTGEventBtn",function(){mtgEvents&&(currentEventIndex=$(this).data("index"),event=mtgEvents[currentEventIndex],e(event))})}),$(document).ready(function(){if("undefined"!=typeof news_listing_category_slug){var e={"magic-the-gathering":"magic","the-division-2":"division",destiny:"destiny"};e[news_listing_category_slug]&&$.get("/api/news/get/"+e[news_listing_category_slug],function(e){if($("#news-listing-"+news_listing_category_slug+" .loader").hide(),Object.keys(e).length){var t=0;for(const s in e)t++,$("#news-listing-"+news_listing_category_slug).append("<div class='mb-2'>"+t+". <a href='"+e[s].url+"' target='_blank'>"+e[s].title+"</a> | "+e[s].source+"</div>")}else $("#news-widget-"+news_listing_category_slug).remove()})}}),document.addEventListener("DOMContentLoaded",function(){tooltips=new mtgTooltip({basiclands:"zzz",shocklands:"new",fetchlands:"new",painlands:"new",mobile:!1,lazyload:!1})});
